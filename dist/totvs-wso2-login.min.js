/**
* @license TOTVS | HTML Framework 12.1.17-fix1
* (c) 2015-2017 TOTVS S/A https://www.totvs.com
* License: Comercial
*/

!function(){"use strict";angular.module("totvsWso2Config",["totvsWso2Oauth"])}(),function(){"use strict";angular.module("totvsWso2Interceptor",["totvsWso2Oauth"])}(),function(){"use strict";angular.module("totvsWso2Login",["totvsWso2Oauth","totvsWso2Config","totvsWso2Interceptor"])}(),function(){"use strict";angular.module("totvsWso2Oauth",["ngCookies"])}(),function(){"use strict";function t(t,e,o){r.redirectUrl&&o.getAccessToken()}angular.module("totvsWso2Oauth").provider("TotvsWso2Oauth",function(){function t(t,n,s){function c(){return t.totvsWso2Token}function i(){return t.totvsWso2Type}return{getAccessToken:function(){"/totvsWso2Token"!==s.path()&&o&&(o=!1,r.redirectUrl?n.put("totvsWso2Redirect",r.redirectUrl):n.put("totvsWso2Redirect",window.location.href),window.location.replace(e))},getAuthorizationHeader:function(){var t=null;return c()&&i()&&(t=i()+" "+c()),console.log("WSO2 authorization header:"+t),t},setAccessToken:function(t){angular.isString(t)&&(n.put("totvsWso2Token",t),console.log("WSO2 access token: "+t))},setTokenType:function(t){angular.isString(t)&&(n.put("totvsWso2Type",t),console.log("WSO2 token type: "+t))},getUrl:function(){return n.get("totvsWso2Redirect")}}}this.configure=function(t){angular.extend(r,t),"/"===r.baseUrl.substr(-1)&&(r.baseUrl=r.baseUrl.slice(0,-1)),r.callbackUrl||(r.callbackUrl=$("base")[0].href+"totvsWso2Token"),e=r.baseUrl+"/oauth2/authorize?response_type=token&client_id="+r.clientId+"&redirect_uri="+r.callbackUrl,console.log("WSO2 redirect URI: "+e)},this.$get=t,t.$inject=["$cookies","$cookieStore","$location"]}).run(t);var e,o=!0,r={baseUrl:"",clientId:"",callbackUrl:null};t.$inject=["$cookies","$cookieStore","TotvsWso2Oauth"]}(),function(){"use strict";function t(t,e,o,r){function n(t,e){var o,r,n,s,c,i=t.search();if(i.access_token)r=i.access_token,n=i.token_type;else for(i=t.hash().split("&"),o=0;o<i.length;o++)if((c=i[o].split("=")).length>1)switch(c[0]){case"access_token":r=c[1];break;case"token_type":n=c[1]}return r&&n&&(e.setAccessToken(r),e.setTokenType(n),s=e.getUrl()),s}t.interceptors.push("totvsWso2Interceptor"),e.state({name:"totvsWso2Token",url:"/totvsWso2Token",resolve:{redirectUrl:n},controller:function(t,e){e&&window.location.replace(e)}}),n.$inject=["$location","TotvsWso2Oauth"]}angular.module("totvsWso2Config").config(t),t.$inject=["$httpProvider","$stateProvider","$urlRouterProvider","$locationProvider"]}(),function(){"use strict";function t(t,e,o,r){function n(){var t=o.get("$modal");return s||(s=t.open({template:'<totvs-modal-header>API Manager</totvs-modal-header><totvs-modal-body><alert type="danger">Usuario sem permissao</alert></totvs-modal-body>',size:"md",backdrop:"static",keyboard:!1})),s.result}var s;return{request:function(t){return t.headers=t.headers||{},!t.headers.hasOwnProperty("Authorization")&&r.getAuthorizationHeader()&&(t.headers.Authorization=r.getAuthorizationHeader()),t},responseError:function(t){if(401===t.status)r.getAccessToken();else if(403===t.status)return n();return e.reject(t)},response:function(t){return t},requestError:function(t){return e.reject(t)}}}angular.module("totvsWso2Interceptor").factory("totvsWso2Interceptor",t),t.$inject=["$rootScope","$q","$injector","TotvsWso2Oauth"]}();