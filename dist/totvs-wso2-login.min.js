/**
* @license TOTVS | HTML Framework 12.1.17-fix1
* (c) 2015-2017 TOTVS S/A https://www.totvs.com
* License: Comercial
*/

!function(){"use strict";angular.module("totvsWso2Config",["totvsWso2Oauth"])}(),function(){"use strict";angular.module("totvsWso2Interceptor",["totvsWso2Oauth"])}(),function(){"use strict";angular.module("totvsWso2Login",["totvsWso2Oauth","totvsWso2Config","totvsWso2Interceptor"])}(),function(){"use strict";angular.module("totvsWso2Oauth",["ngCookies"])}(),function(){"use strict";function t(t,o,e){r.redirectUrl&&e.getAccessToken()}angular.module("totvsWso2Oauth").provider("TotvsWso2Oauth",function(){function t(t,n,s){function c(){return t.totvsWso2Token}function i(){return t.totvsWso2Type}return{getAccessToken:function(){"/totvsWso2Token"!==s.path()&&e&&(e=!1,r.redirectUrl?n.put("totvsWso2Redirect",r.redirectUrl):n.put("totvsWso2Redirect",window.location.href),window.location.replace(o))},getAuthorizationHeader:function(){var t=null;return c()&&i()&&(t=i()+" "+c()),console.log("WSO2 authorization header:"+t),t},setAccessToken:function(t){angular.isString(t)&&(n.put("totvsWso2Token",t),console.log("WSO2 access token: "+t))},setTokenType:function(t){angular.isString(t)&&(n.put("totvsWso2Type",t),console.log("WSO2 token type: "+t))},getUrl:function(){return n.get("totvsWso2Redirect")}}}this.configure=function(t){angular.extend(r,t),"/"===r.baseUrl.substr(-1)&&(r.baseUrl=r.baseUrl.slice(0,-1)),r.callbackUrl||(r.callbackUrl=$("base")[0].href+"totvsWso2Token"),o=r.baseUrl+"/oauth2/authorize?response_type=token&client_id="+r.clientId+"&redirect_uri="+r.callbackUrl,console.log("WSO2 redirect URI: "+o)},this.$get=t,t.$inject=["$cookies","$cookieStore","$location"]}).run(t);var o,e=!0,r={baseUrl:"",clientId:"",callbackUrl:null};t.$inject=["$cookies","$cookieStore","TotvsWso2Oauth"]}(),function(){"use strict";function t(t,o,e,r){function n(t,o){var e,r,n,s,c,i=t.search();if(i.access_token)r=i.access_token,n=i.token_type;else for(i=t.hash().split("&"),e=0;e<i.length;e++)if((c=i[e].split("=")).length>1)switch(c[0]){case"access_token":r=c[1];break;case"token_type":n=c[1]}return r&&n&&(o.setAccessToken(r),o.setTokenType(n),s=o.getUrl()),s}t.interceptors.push("totvsWso2Interceptor"),o.state({name:"totvsWso2Token",url:"/totvsWso2Token",resolve:{redirectUrl:n},controller:function(t,o){o&&window.location.replace(o)}}),n.$inject=["$location","TotvsWso2Oauth"]}angular.module("totvsWso2Config").config(t),t.$inject=["$httpProvider","$stateProvider","$urlRouterProvider","$locationProvider"]}(),function(){"use strict";function t(t,o,e,r){function n(){var t=e.get("$modal");return i||(i=o(function(t,o){})),c||(c=t.open({template:'<totvs-modal-header>API Manager</totvs-modal-header><totvs-modal-body><alert type="danger">Usuario sem permissao</alert></totvs-modal-body>',size:"md",backdrop:"static",keyboard:!1})),c.result}function s(){return i||(i=o(function(t,o){})),a||(r.getAccessToken(),a=o(function(t,o){})),a}var c,i,a;return{request:function(t){return t.headers=t.headers||{},i||(!t.headers.hasOwnProperty("Authorization")&&r.getAuthorizationHeader()&&(t.headers.Authorization=r.getAuthorizationHeader()),t)},responseError:function(t){return 401===t.status?s():403===t.status?n():o.reject(t)},response:function(t){return t},requestError:function(t){return o.reject(t)}}}angular.module("totvsWso2Interceptor").factory("totvsWso2Interceptor",t),t.$inject=["$rootScope","$q","$injector","TotvsWso2Oauth"]}();